---
layout: post
title:  "SanghyunPark - About Project (1)"
date:   2022-03-04 10:00:00 -0500
categories: 일기 SanghyunPark
---

이번/다음 일기는 Project 진행과 그 과정을 중점에 두려 한다.
솔직한 마음으로 프로젝트에 대해 서술하겠다.
내가 한 일들에 초점이 맞춰져 있다. 따라서 내가 다루지 않은 기술들은 특별히 서술하지 않겠다.


## 프로젝트 주제 선정

사실 우리 팀의 처음 주제는 Shot Tracker가 아니었다. 원래 주제는 Air Quality와 환경 오염에 대한 주제였던것 같다.
솔직히 팀을 마지막에 합류한 사람으로서 주제보다는 팀원을 보고 합류한 경향이 크다. 원래 IoT 주제 모두에 관심이 있었기에 어떤 주제를 하든 큰 상관은 없었다.
마침 정말 실력이 좋은 팀원들로 구성된 팀이 있었고, 운좋게 그 팀(현재 팀)에 합류할 수 있었다. (사실 3-2학기가 너무 힘들었어서 묻어가고 싶은 마음이 컸다)

그렇게 미국에서 Air Condition 프로젝트 관련 회의를 하던 중 Tony 교수님께서 새로운 주제를 들고 오셨다. 처음에는 정말 관심 없었다. 바꾸기 싫었다. 교수님께서는 Commercialize 를 목표로도 하신다고 하셨는데, 나는 돈벌이에는 관심이 없었기도 했고, 총 관련된 주제가 수요가 많을, 적절한 주제일지 고민했다. 너무 비인기 주제로 파고들긴 싫었기 때문이다.

결국 우리 팀은 주제 변경을 놓고 회의를 진행하였다. 

팀원 모두가 각각의 합리적인 의견을 냈다. 해당 회의를 진행하면서 어느 팀원의 말에 설득당했던 것 같다.
그 팀원은 "실제로 가치가 있을것 같은, 잘 만들면 누군가는 필요로 할 것 같은" Project를 진행하고 싶다고 했다.
3년 전 OOP 수업에서 정상근 교수님은 다음과 같은 말을 하셨다. "코딩은 Real World의 문제들을 Computer World에서 쉽게 해결하도록 해준다."
나도 교수님의 말에 전적으로 동의했었다. 단순히 코딩실력을 자랑하고 버려지는 프로그램보다는, 누군가 정말 필요로 하고 실제로 사용하는 프로그램을 만들고 싶었다.
팀원의 말을 듣고 나니 확신이 섰다. 기존의 주제는 내가 만들더라도 누군가 사용할 것 같지 않아보였다.

그렇게 우리는 Shot Tracker 주제를 선택하게 되었다.


## 프로젝트 진행

### IoT System 설계

처음에는 프로젝트의 시나리오를 설계했다. 누가, 어디서, 어떻게 이 시스템을 사용할지를 정하였다.
우리는 several miles away 에서도 동작하는 실시간 Shot Tracking, Shot Group Measuring System을 설계하였다.

다양한 통신 방법들이 존재하였지만, 장거리 통신을 목적으로 하다 보니 자연스레 선택지가 좁혀졌다.

1. LoRa
2. WiFi with Antenna

2번은 너무 쉬웠다. 재미도 없을 것 같았고, 도전하는 느낌이 나질 않았다. 실제로 논문을 작성한다 했을 때 딱히 내세울것도 없었다. 단점투성이었다.
그래서 우리는 LoRa를 장거리 통신으로 이용하기로 하였다.

하드웨어는 Raspberry Pi와 LoRa Hat, Sound Sensor를 이용하였다.


### 선행 연구

Shot Marker라는 기존의 제품이 있었다. 이 제품은 보면 볼수록 완벽했는데, 다행히 우리가 novelty를 가질만한 단점들을 지니고 있었다.
Acoustic Nodes를 사용하기 때문에 Super- and Sub-sonic bullet들을 탐지하지 못하였다.
또한, Local WiFi를 AP로 이용하여 Device로 데이터를 중계해주는데, WiFi는 전력소모가 심했다.
결과적으로 이 제품은 비쌌다.


### YOLO V5의 이용

우리는 총알 자국을 Object Detection을 이용하여 탐지하기로 하였다. 기존의 Shot Marker의 단점으로 Acoustic Nodes를 사용한다는 것이 있었는데, 우리 방식으로는 이 문제를 말끔이 해결할 수 있었다.

나는 기계학습 강의를 수강하지 않았다. 예전에 머신러닝과 딥러닝에 관심있던 때가 있어 어느정도 기본 배경지식은 있었지만, 데이터 구축과 모델 학습, detect 등에 대해서는 하나도 알지 못하였다.
다행히 우리 팀원들은 기계학습 강의를 수강하였고, Object Detection, 특히 YOLO를 사용한 경험이 있었다. 이를 바탕으로 (1주일만에..) 총알 자국 데이터를 수집, 라벨링 하고 모델을 만든 뒤 detect를 꽤 정확하게 하는데 성공했다.

좋은 팀원들을 만나 행복했던, 수없이 많았던 순간들 중 하나였다.


### Pi Camera Setting

라즈베리 파이를 이용함에 따라 파이 카메라를 설치하였다. 동아리 S.P.G에서 라즈베리 파이와 아두이노를 다뤄본 경험을 살려서 잘 해낼 수 있었다.


### LoRa는 사람을 화가 나게 해요

LoRa가 문제였다. 처음에는 WaveShare의 LoRa Hat을 이용하였다. 그런데, 작동이 안되었다. 그냥 안되었다. 이유를 모르겠다.
이것때문에 2주는 날린것 같다. 화가 났다. 많이 났다.
결국 Tony교수님 연구실에 있는 Dragino LoRa Shield를 이용하여 임시로 Arduino와 연결짓고 전송이 되는데까지만 하기로 하였다.

다행히 Dragino LoRa Shield는 정상적으로 작동하였다.

그런데, 너무 느렸다. 데이터 통신 시간에 배운 Flow Control이 필요해 보였다.
Arduino에서 받은 데이터를 Raspberry Pi로 올리는 식으로 구현을 했는데, Raspberry Pi로 데이터를 올리는 시간이 Arduino에서 데이터를 받아오는 시간보다 터무니 없이 느려 계속하여 버퍼가 overwritten되고 있었다.

해결 방안을 찾다 우선 데이터가 전송되는것에 만족하고 Image Trasmission과 Sound Sensor에 집중하기로 하였다.

다음 일기에 계속..